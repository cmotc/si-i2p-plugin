-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Destination-Isolating i2p HTTP Proxy(SAM Application)
=====================================================

*one eepSite, one destination.*

This is an i2p SAM application which presents an HTTP proxy(on port 4443 by
default) that acts as an intermediate between your browser and the i2p network.
Then it uses the SAM library to create a unique destination for each i2p site
that you visit. This way, your unique destination couldn't be used to track you
with a network of colluding sites. I doubt it's a substantial problem right now
but it might be someday. Facebook has an onion site, and i2p should have
destination isolation before there is a facebook.i2p.

Excitingly, after like a year of not being able to devote the time I should
have to this, I've finally made it work. I am successfully using this proxy to
browse eepSites pretty normally. There are still a few bugs to chase down, but
if somebody else wanted to try it out, I might not *totally* embarass myself.

What works so far:
- ------------------

### The http proxy

Again, *still pretty experimental*, but currently it is possible to set
your web browser's HTTP proxy to localhost:4443 and use it to browse eepSites.
I haven't been able to crash it or attack it by adapting known attacks on
browsers and HTTP proxies to this environment. It should at least fail early if
something bad happens.

I am now fairly certain that it can't be forced to retrieve URL's outside the
i2p network under normal circumstances in properly configured browsers. Intrepid
observers may find it fun to start testing things now. Funnily enough, it would
have crashed under vanilla firefox last week because the captive portal shit.
Failed closed though, and now it's handled more gracefully.

OK so addresshelpers are partly implemented, but not fully. In order to complete
it I'll have to change how failed lookups are handled. This should be
straightforward.

#### Examples

##### firefox

![Firefox Configuration](misc/firefox.png)

##### curl

        curl -x 127.0.0.1:4443 http://i2p-projekt.i2p

##### surf

        export http_proxy="http://127.0.0.1:4443" surf http://i2p-projekt.i2p

#### Current Concerns:

If it wasn't super, super obvious to everyone, it's really, really easy to tell
the difference between this proxy and the default i2p/i2pd http proxies and I
don't think there's anything I can do about that.

It checks to see if it's getting an i2p url by splitting it at the first ".i2p"
which unfortunately means that I can't use it to visit trac.i2p2.i2p.

I am currently attacking this proxy while using various browsers. It seems more
complicated browsers are easier to attack. They might even do something
ridiculous, like presume you're using a captive portal and attempt to direct
you to a captive portal login assistance page. God captive portals are fucking
stupid. Who knew? Seriously, stay off my clearly labeled sites.

I am now fairly certain that it can't be forced to retrieve URL's outside the
i2p network in properly configured browsers under normal circumstances. Remember
to set [*] Use this proxy server for all protocols or other relevant browser
configurations. This appears to be the default behavior for surf and uzbl.

Before version 0.21, a framework for generating service tunnels ad-hoc will also
be in place. This will be used for fuzz-testing the http proxy and the pipe
proxy. Almost everything will be improved by the availability of this.

I haven't implemented addresshelpers/jump host interaction yet, but I have a
good idea how to now.

It would appear that, since it doesn't have to do lookups for sites that it has
already created a tunnel for, this proxy can sometimes be faster than the
standard http proxy. I'm not sure how to confirm this but will attempt to
correlate it with longitudinal testing.

### The pipes

Moved to [misc/docs/PIPES.md](misc/docs/PIPES.md)

What I'm doing right now:
- -------------------------

Implementing pipe-controlled service tunnels.

What the final version should do:
- ---------------------------------

The final version should use the parent pipe and the aggregating pipe to send
and recieve requests as an http proxy in the familiar way.

Version Roadmap:

  * ~~0.17 - Named Pipes work for top-level i2p domains and can retrieve~~
   ~~directories under a site~~
  * ~~0.18 - Named Pipes for i2p domains and can retrieve subdirectories,~~
   ~~which it caches in clearly-named folders as normal files(Containing HTML)~~
  * ~~0.19 - Expose an http proxy that hooks up to the existing infrastructure~~
   ~~for destination isolation~~
  * 0.20 - ~~Ready for more mainstream testing~~, ~~should successfully isolate~~
   ~~requests for resources embedded in the retrieved web pages~~ Addresshelper.
  * 0.21 - Should be able to generate services on the fly by talking to the SAM
  bridge. First worthwhile release for people who aren't shell enthusiasts.

Silly Questions I'm asking myself about how I want it to work:
- --------------------------------------------------------------

Definitely not going to do any more filtering than I already do. Instead I'm
going to do build a different proxy to do that and demonstrate how to connect
the two.

For right not, this proxy is definitely only intended for browsing in the i2p
network and should not be combined with Tor in like, a FoxyProxy type situation,
until someone has figured if there's a way to guarantee TorButton and all the
Stream-Isolation stuff works.

Installation and Usage:
=======================

Moved to [misc/docs/INSTALL.md](misc/docs/INSTALL.md)

Screenshots:
- ------------

### using surf with classic proxy against 3 test sites.

![Proof-of-Concept using surf with classic proxy against 3 test sites.](misc/screenshot-classic.png)

### using surf against 3 test sites.

![Proof-of-Concept using surf against 3 test sites.](misc/screenshot-browser.png)

### using the new proxy against the same site twice.

![Proof-of-Concept using the new proxy against the same site twice.](misc/screenshot-browser-samesite.png)

### using Firefox against test site 1.

![Proof-of-Concept using Firefox against test site 1.](misc/screenshot-firefox-1.png)

### using Firefox against test site 2.

![Proof-of-Concept using Firefox against test site 2.](misc/screenshot-firefox-2.png)

### using Firefox against test site 3.

![Proof-of-Concept using Firefox against test site 3.](misc/screenshot-firefox-3.png)

### using multiple visits to all test sites.

![Proof-of-Concept using multiple visits to all test sites.](misc/screenshot-multivisit.png)

### screenshot of it in development, with the pipes.

![Proof-of-Concept screenshot of it in development, with the pipes.](misc/screenshot-pipes.png)
-----BEGIN PGP SIGNATURE-----

iQEzBAEBCAAdFiEEcNIGBzi++AUjrK/311wDs5teFOEFAlrQTZMACgkQ11wDs5te
FOEwJQf+NLJudolPfl2GYIHwwDKbQRyrCJd0oJY4bXVCfZ66m/QmqCPwlICpmT6o
GmKT1edvWaZJ+RbbxlB5IIu7pskNosAR4afNKhypXpBarhriFnkaTAQ3AwLoczJa
gXBtxCGzgUdyYol25c+SGL+YkQpkhEz7dIMbLY+GJxaEruhsCSQTlsn2t2stLM6p
KK+0ysX+bYhK+OKA3mgF4BUcQP0VrLPv7GymEcd+x3lL3WARP2amQAdA/ODRPzau
Jp2O3zhm+UTGm6W1u8kkBrvLEsu1P4tGvOCP/9rDf4WirWLdRuwQE1LhfGj0DFOx
0JXFZzYL7wX0edTxtOzjj0RE7urKEQ==
=5pT9
-----END PGP SIGNATURE-----
